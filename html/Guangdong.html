<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <title>广东</title>
  <meta name="description" content="">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
</head>

<body>
    <div>
        <svg id="mysvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1369 1141" 
        preserveAspectRatio="xMidYMid meet"
        width="15.2111in" 
        height="12.6778in">
            <!--建立坐标-->
            <g>
                <line x1="30" y1="30" x2="1010" y2="30"
                style="stroke:rgb(143,143,143); stroke-width:1"></line>
                <line x1="30" y1="100" x2="1010" y2="100"
                style="stroke:rgb(143,143,143); stroke-width:1"></line>
                <line x1="30" y1="170" x2="1010" y2="170"
                style="stroke:rgb(143,143,143); stroke-width:1"></line>
                <line x1="30" y1="240" x2="1010" y2="240"
                style="stroke:rgb(143,143,143); stroke-width:2"></line>
                <line x1="30" y1="310" x2="1010" y2="310"
                style="stroke:rgb(143,143,143); stroke-width:2"></line>
                <line x1="30" y1="380" x2="1010" y2="380"
                style="stroke:rgb(143,143,143); stroke-width:2"></line>
        
                
                <line x1="30" y1="0" x2="30" y2="380"
                style="stroke:rgb(143,143,143); stroke-width:1"></line>
            <!--在坐标图上添加刻度说明-->>
                <text x="10" y="380" fill="#333">0</text>
                <text x="0" y="310" fill="#333">3000</text>
                <text x="0" y="240" fill="#333">6000</text>
                <text x="0" y="170" fill="#333">9000</text>
                <text x="0" y="100" fill="#333">12000</text>
                <text x="0" y="30" fill="#333">15000</text>
            
                <text x="10" y="400" fill="#333">01.27</text>
                <text x="80" y="400" fill="#333">01.29</text>
                <text x="150" y="400" fill="#333">01.31</text>
                <text x="220" y="400" fill="#333">02.02</text>
                <text x="290" y="400" fill="#333">02.04</text>
                <text x="360" y="400" fill="#333">02.06</text>
                <text x="430" y="400" fill="#333">02.08</text>
                <text x="500" y="400" fill="#333">02.10</text>
                <text x="570" y="400" fill="#333">02.12</text>
                <text x="640" y="400" fill="#333">02.14</text>
                <text x="710" y="400" fill="#333">02.16</text>
                <text x="780" y="400" fill="#333">02.18</text>
                <text x="850" y="400" fill="#333">02.20</text>
            <!--绘制折线-->
                <polyline id="poly" points="30,350 100,356 170,349 240,331 310,306 380,323 450,330 520,331 
                    590,38 660,324 730,335 800,341 870,365" style="fill:none;stroke:#3fc371;stroke-width:2"/>
            </g>  
            <!--绘制折线点，鼠标移到点上显示说明文字
            <g>
            <circle cx="30" cy="350" r="8" stroke="rgba(63,195,113,0.4)"
                stroke-width="1" fill="none"/>
        
            <circle id="p1" cx="30" cy="350" r="4" stroke="rgba(63,195,113,0.4)"
                stroke-width="4" fill="#3fc371"/>
            <text id="t1" x="15" y="300" font-size="18" style="fill:rgb(253, 255, 254);" >1.27:
                <set attributeName="fill" from="rgb(252, 245, 245)" to="rgb(57, 170, 123)" begin="p1.mouseover" end="p1.mouseout"/>
            </text>;   
            <text x="15" y="325" font-size="18" style="fill:rgb(252, 251, 251);">1447
                <set attributeName="fill" from="rgb(252, 245, 245)" to="rgb(57, 170, 123)" begin="p1.mouseover" end="p1.mouseout"/>
            </text>;          //鼠标移到点上显示说明文字
            

            <circle cx="100" cy="356" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="170" cy="349" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="240" cy="331" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="310" cy="306" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="380" cy="323" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="450" cy="330" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="520" cy="331" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="590" cy="38" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="660" cy="324" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="730" cy="335" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="800" cy="341" r="4" stroke="none" fill="#3fc371"/>
            <circle cx="870" cy="365" r="4" stroke="rgba(63,195,113,0.4)" 
                stroke-width="4" fill="#3fc371"/>
        
            <circle cx="870" cy="365" r="8" stroke="rgba(63,195,113,0.4)"
                stroke-width="1" fill="none"/>
            </g>-->

            <!--设单击该矩形时修改日期，测试DateChange()函数-->
            <g>
                <rect id="text" x="0" y="0" width="50" height="50" style="fill:red;stroke-width:1;stroke:rgb(0,0,0)"></rect>
            </g>
            <!--测试结束-->

            <g>
                <!--<rect id="rect0" x="10" y="420" width="150" height="50" style="fill:rgb(30, 170, 212);stroke-width:1;stroke:rgb(0,0,0)"/>
                -->
                <rect id="rect0" x="10" y="420" width="150" height="50" fill="rgb(30, 170, 212)" style="stroke-width:1;stroke:rgb(0,0,0)"/>
                <text x="30" y="450" font-size="18" style="fill:rgb(255, 255, 255);">新增确诊趋势</text>
                <rect id="rect1" x="170" y="420" width="150" height="50" fill="rgb(196, 191, 191)" style="stroke-width:1;stroke:rgb(0,0,0)"/>
                <text x="190" y="450" font-size="18" style="fill:rgb(255, 255, 255);">累计确诊趋势</text>
                <rect id="rect2" x="330" y="420" width="150" height="50" fill="rgb(196, 191, 191)" style="stroke-width:1;stroke:rgb(0,0,0)"/>
                <text x="350" y="450" font-size="18" style="fill:rgb(255, 255, 255);">累计治愈趋势</text>
                <rect id="rect3" x="490" y="420" width="150" height="50" fill="rgb(196, 191, 191)" style="stroke-width:1;stroke:rgb(0,0,0)"/>
                <text x="510" y="450" font-size="18" style="fill:rgb(255, 255, 255);">累计死亡趋势</text>
            </g>

        </svg>
    </div>

    <!--互动事件-->
    <script type="text/javascript">
        var howManyDate= [];//存放日期
        var date = [] ;//二维数组，存放对应新增确诊、累计确诊、治愈、死亡人数
        var pNumber = 14 ; //折线图中有十四个点
        var polyline = "" ;
        var nDate = 14; //默认日期在date中所处位置

        //模拟日期修改，测试函数CreatPolyLine
        var dateChange = document.getElementById('text');
        for(var k =0;k<15;k++){ //初始化date、howManyDate
            var l;
            date[k]= [] ;
            for(l=0;l<4;l++){
                date[k].push(1000+1000*l);
            }
            var s;
            s="2."+k;
            howManyDate.push(s);
        }
        dateChange.addEventListener('click', function(e) {//单击调整日期时触发事件
            console.log('text clicked - enlarging');
            dateChange.setAttribute("width","100");
            nDate=9;//判断所选日期在date中位置
            CreatPolyLine(nDate,0);
        }, false);
        //测试结束

        //切换到新增确诊趋势/累计确诊趋势/累计治愈趋势/累计死亡趋势
        var rect0 = document.getElementById('rect0');
        var rect1 = document.getElementById('rect1');
        var rect2 = document.getElementById('rect2');
        var rect3 = document.getElementById('rect3');
        rect0.addEventListener('click', function(e) {
            console.log('rect0 clicked - enlarging');
            rect0.setAttribute("fill","rgb(30, 170, 212)");
            rect1.setAttribute("fill","rgb(196, 191, 191)");
            rect2.setAttribute("fill","rgb(196, 191, 191)");
            rect3.setAttribute("fill","rgb(196, 191, 191)");
            CreatPolyLine(nDate,0);
        }, false);
        rect1.addEventListener('click', function(e) {
            console.log('rect1 clicked - enlarging');
            rect1.setAttribute("fill","rgb(30, 170, 212)");
            rect0.setAttribute("fill","rgb(196, 191, 191)");
            rect2.setAttribute("fill","rgb(196, 191, 191)");
            rect3.setAttribute("fill","rgb(196, 191, 191)");
            CreatPolyLine(nDate,1);
        }, false);
        rect2.addEventListener('click', function(e) {
            console.log('rect2 clicked - enlarging');
            rect2.setAttribute("fill","rgb(30, 170, 212)");
            rect1.setAttribute("fill","rgb(196, 191, 191)");
            rect0.setAttribute("fill","rgb(196, 191, 191)");
            rect3.setAttribute("fill","rgb(196, 191, 191)");
            CreatPolyLine(nDate,2);
        }, false);
        rect3.addEventListener('click', function(e) {
            console.log('rect3 clicked - enlarging');
            rect3.setAttribute("fill","rgb(30, 170, 212)");
            rect1.setAttribute("fill","rgb(196, 191, 191)");
            rect2.setAttribute("fill","rgb(196, 191, 191)");
            rect0.setAttribute("fill","rgb(196, 191, 191)");
            CreatPolyLine(nDate,3);
        }, false);

        //生成趋势折线图,参数nDate为当前所选日期在date数组中所在位置
        //style：0-新增确诊趋势，1-累计确诊趋势，2-治愈趋势，3-死亡趋势
        function CreatPolyLine(nDate,style){
            polyline="";
            var i = ( ( nDate >= date.length ) ? ( nDate - point ) : 0 );
            var poly = document.getElementById('poly');
            var j;
            for( j = 0 ; i <= nDate ; i ++ ,j ++ ){
                var x = 30 + 70 * j ;
                var y = 380 - ( date[nDate][style] * ( 70 / 3000 ) );
                polyline += x + "," + y ;
                if ( ( i + 1 ) <= nDate ){
                    polyline += " ";
                }
            }
            poly.setAttribute("points",polyline);

            //隐藏原有X轴坐标
            var oldText =document.getElementsByTagName("text");
            for( j =0 ; j < oldText.length ; j ++){
                if(oldText[j].getAttribute("y") == 400){
                    oldText[j].setAttribute("fill","white");
                }
            }

            //建立新X轴坐标
            i = ( ( nDate >= date.length ) ? ( nDate - point ) : 0 );
            for( j = 0 ; i <= nDate ; j ++ , i ++ ){
                var svg =document.getElementById('mysvg');
                var sdate ="";
                var x = "" ;
                x = 10 + j * 70 ;
                sdate += howManyDate [i];
                var newText = document.createElementNS("http://www.w3.org/2000/svg", "text");
                newText.setAttribute("x", x);
                newText.setAttribute("y", "400");
                newText.setAttribute("fill", "#333");
                newText.appendChild(document.createTextNode(sdate));
                svg.appendChild(newText);
            }
        }

    </script>
</body>